<!-- <div class="create-route-layout">
    <div class="form-container">
        <div class="first-form">
            <mat-form-field>
                <input matInput [(ngModel)]="name" placeholder="Название">
            </mat-form-field>
            <mat-form-field>
                <input matInput [(ngModel)]="description" placeholder="Описание">
            </mat-form-field>
            <mat-form-field>
                <mat-select placeholder="Деталь" (change)="filterOperations(detail)" [(ngModel)]="detail">
                    <mat-option *ngFor="let detail of details" [value]="detail">
                        {{ detail.title }}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <mat-divider></mat-divider>

        <mat-form-field>
            <mat-select placeholder="Операция" [disabled]="!detail" [(ngModel)]="operation">
                <mat-option *ngFor="let operation of viewOperations" [value]="operation">
                    {{ operation.name }} ({{ operation.equipment.conveyor?.name||operation.equipment.workshop?.name }})
                </mat-option>
            </mat-select>
        </mat-form-field>
        <button mat-raised-button class="add-operation-button" color="primary" (click)="addOperation()" [disabled]="!operation">Добавить операцию</button>

        <div class="warning-message">
            Расположите операции в том порядке, в котором деталь должна их проходить.
            <br> У детали должна быть одна операция сборки и >1 операций обработки.
            <br> Если операции по цехам перепутаны местами, то порядок цехов будет выбран автоматически.
        </div>

        <div class="operations-list">
            <div class="list-item" id="{{operation.id}}" *ngFor="let operation of addedOperations;let i =index;">
                <div class="mat-line">
                    <span class="operation-name">{{ operation.name }} ({{ operation.equipment.conveyor?.name||operation.equipment.workshop?.name }})</span>
                    <button [disabled]="addedOperations.length<2" mat-mini-fab color="primary" (click)="moveDown(operation)">
                        <mat-icon>expand_more</mat-icon>
                    </button>
                    <button [disabled]="addedOperations.length<2" mat-mini-fab color="primary" (click)="moveUp(operation)">
                        <mat-icon>expand_less</mat-icon>
                    </button>
                </div>
                <mat-divider></mat-divider>
            </div>
        </div>

    </div>

    <footer>
        <button mat-raised-button color="primary" (click)="createRoute()" [disabled]="!name||!addedOperations.length||!isValidSequence()">Создать маршрут</button>
        <div style="flex:1"></div>
        <button mat-raised-button color="primary" (click)="closeDialog()">Закрыть</button>
    </footer>
</div> -->
<div class="create-route-layout">
    <mat-card>
        <div class="loading" *ngIf="savingLoading">
            <mat-progress-spinner color="primary" mode="indeterminate" [strokeWidth]="8"></mat-progress-spinner>
        </div>

        <header>
            <mat-form-field class="name">
                <input matInput [(ngModel)]="name" placeholder="Название">
            </mat-form-field>
            <mat-form-field class="description">
                <input matInput [(ngModel)]="description" placeholder="Описание">
            </mat-form-field>

            <button mat-raised-button color="primary" (click)="createRoute()">Создать маршрут</button>
        </header>
        <mat-divider></mat-divider>
        <main>
            <div class="column first">

                <div class="table-container">
                    <div class="loading" *ngIf="detailsLoading">
                        <mat-progress-spinner color="primary" mode="indeterminate" [strokeWidth]="8"></mat-progress-spinner>
                    </div>

                    <mat-table #table [dataSource]="detailsDataSource">
                        <ng-container matColumnDef="title">
                            <mat-header-cell *matHeaderCellDef class="title"> Название </mat-header-cell>
                            <mat-cell *matCellDef="let detail" class="title"> {{detail.title}} </mat-cell>
                        </ng-container>

                        <ng-container matColumnDef="description">
                            <mat-header-cell *matHeaderCellDef class="description"> Описание </mat-header-cell>
                            <mat-cell *matCellDef="let detail" class="description"> {{detail.description}} </mat-cell>
                        </ng-container>

                        <mat-header-row *matHeaderRowDef="detailsDisplayedColumns"></mat-header-row>
                        <mat-row (click)="selectDetail(detail)" *matRowDef="let detail; columns: detailsDisplayedColumns;" [ngClass]="selectedDetail&&selectedDetail.id===detail.id?'selected':''"></mat-row>
                    </mat-table>

                    <mat-divider></mat-divider>

                    <div>
                        <mat-paginator [length]="detailsPageLength" [pageIndex]="detailsPageNumber" [pageSize]="detailsPageSize" [pageSizeOptions]="pageSizeOptions"
                            (page)="handleDetailsPageEvent($event)"></mat-paginator>
                    </div>
                </div>
            </div>

            <div class="column second">
                <mat-table #table [dataSource]="operationsDataSource">
                    <ng-container matColumnDef="name">
                        <mat-header-cell *matHeaderCellDef class="name"> Название </mat-header-cell>
                        <mat-cell *matCellDef="let operation" class="name"> {{operation.name}} </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="equipment">
                        <mat-header-cell *matHeaderCellDef class="equipment"> Оборудование </mat-header-cell>
                        <mat-cell *matCellDef="let operation" class="equipment"> {{operation.equipment.name}} ({{operation.equipment.workshop?operation.equipment.workshop.name: (operation.equipment.conveyor?operation.equipment.conveyor.name:'')}})
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="add-button">
                        <mat-header-cell class="add-button" *matHeaderCellDef></mat-header-cell>
                        <mat-cell class="add-button" *matCellDef="let operation">
                            <button mat-icon-button color="primary" (click)="addOperation(operation)" [disabled]="isOperationSelected(operation)">
                                <mat-icon>add</mat-icon>
                            </button>
                        </mat-cell>
                    </ng-container>

                    <mat-header-row *matHeaderRowDef="operationsDisplayedColumns"></mat-header-row>
                    <mat-row (click)="selectOperation(operation)" [ngClass]="isOperationSelected(operation)?'selected':''" *matRowDef="let operation; columns: operationsDisplayedColumns;"></mat-row>
                </mat-table>
                <mat-divider></mat-divider>

                <div>
                    <mat-paginator [length]="operationsPageLength" [pageIndex]="operationsPageNumber" [pageSize]="operationsPageSize" [pageSizeOptions]="pageSizeOptions"
                        (page)="handleOperationsPageEvent($event)"></mat-paginator>
                </div>
            </div>

            <div class="column third">
                <mat-table #table [dataSource]="operationsDataSource">
                    <ng-container matColumnDef="name">
                        <mat-header-cell *matHeaderCellDef class="name"> Название </mat-header-cell>
                        <mat-cell *matCellDef="let operation" class="name"> {{operation.name}} </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="equipment">
                        <mat-header-cell *matHeaderCellDef class="equipment"> Оборудование </mat-header-cell>
                        <mat-cell *matCellDef="let operation" class="equipment"> {{operation.equipment.name}} ({{operation.equipment.workshop?operation.equipment.workshop.name: (operation.equipment.conveyor?operation.equipment.conveyor.name:'')}})
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="add-button">
                        <mat-header-cell class="add-button" *matHeaderCellDef></mat-header-cell>
                        <mat-cell class="add-button" *matCellDef="let operation">
                            <button mat-icon-button color="primary" (click)="addOperation(operation)">
                                <mat-icon>add</mat-icon>
                            </button>
                        </mat-cell>
                    </ng-container>

                    <mat-header-row *matHeaderRowDef="operationsDisplayedColumns"></mat-header-row>
                    <mat-row *matRowDef="let operation; columns: operationsDisplayedColumns;"></mat-row>
                </mat-table>
                <mat-divider></mat-divider>

                <div>
                    <mat-paginator [length]="operationsPageLength" [pageIndex]="operationsPageNumber" [pageSize]="operationsPageSize" [pageSizeOptions]="pageSizeOptions"
                        (page)="handleOperationsPageEvent($event)"></mat-paginator>
                </div>
            </div>
        </main>
    </mat-card>

</div>
